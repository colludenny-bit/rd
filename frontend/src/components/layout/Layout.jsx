import React, { useState } from 'react';
import { Outlet } from 'react-router-dom';
import { Menu } from 'lucide-react';
import { Sidebar } from './Sidebar';
import { MobileNav } from './MobileNav';
import { Particles } from '../ui/Particles';

// Karion Logo SVG Component with smoke shadow
const KarionLogo = ({ className = "", size = "default" }) => {
  const sizes = {
    small: { width: 120, height: 42 },
    default: { width: 180, height: 62 },
    large: { width: 220, height: 76 }
  };
  const { width, height } = sizes[size] || sizes.default;
  
  return (
    <div className={`relative ${className}`} style={{ filter: 'drop-shadow(0 4px 8px rgba(180, 180, 180, 0.15))' }}>
      <svg 
        xmlns="http://www.w3.org/2000/svg" 
        viewBox="0 0 16.53 5.7" 
        width={width} 
        height={height}
        className="transition-transform hover:scale-105"
      >
        <defs>
          <linearGradient id="karion-gradient-1" x1="0" x2="1" y1="0" y2="1">
            <stop stopColor="#e4a640" offset="0"/>
            <stop stopColor="#2d2b27" offset="1"/>
          </linearGradient>
          <linearGradient id="karion-gradient-2" x1="0" x2="1" y1="0" y2="1">
            <stop stopColor="#926f35" offset="0"/>
            <stop stopColor="#262626" offset="1"/>
          </linearGradient>
        </defs>
        <g transform="matrix(0.755,0,0,0.755,2.727,2.228)">
          <path d="M7.95-0.9c0,0.03,0.02,0.06,0.01,0.1c-0.01,0.02-0.04,0.04-0.04,0.06c0,0.06,0,0.11-0.05,0.09c-0.02-0.01-0.03-0.01-0.04-0.01c-0.03,0-0.04-0.02-0.04-0.04c-0.01-0.05-0.03-0.08-0.1-0.09c0,0,0,0,0,0c0,0.03-0.02,0.06-0.05,0.09l0.07,0.15c0.01,0.03,0,0.07-0.06,0.1c-0.02,0.01-0.03,0.04-0.05,0.04l-0.01-0.09c0.02-0.01,0.04,0,0.05-0.01c0.01-0.01,0-0.02,0.01-0.03c0.02-0.02-0.04-0.04-0.06-0.08c0.01-0.02,0.02-0.05,0.04-0.07c-0.03,0.02-0.07,0.06-0.08,0.08c-0.03,0.03-0.05,0.07-0.06,0.13c0,0.02,0,0.04,0,0.06c0,0.02-0.02,0.02,0,0.05c0.01,0.02,0.03,0.03,0.04,0.06l-0.09,0c0,0.02,0.01,0.04,0,0.06c-0.03,0.02-0.02,0.08-0.01,0.13c0.01,0.09,0.05,0.16,0.01,0.24c-0.01-0.17-0.14-0.11-0.25-0.11c-0.1,0.01-0.12,0.1-0.1,0.13c0.01,0.02,0.02,0.04,0.03,0.06c0.01,0.01,0,0.03,0.01,0.05c0.01,0.02,0.03,0.03,0.04,0.05l-0.09,0c0,0.02,0.01,0.04,0,0.06c-0.04,0.04-0.04,0.1-0.07,0.15c0.04-0.06,0.13-0.09,0.12-0.17c-0.01,0.07-0.09,0.1-0.13,0.14c-0.03,0.04-0.04,0.07-0.04,0.11c0,0.02-0.02,0.04-0.01,0.07c0.01,0.02,0.03,0.03,0.04,0.06l-0.1,0c0,0.02,0.02,0.04,0.01,0.06c-0.05,0.07-0.04,0.16-0.03,0.24c0,0.08,0.04,0.15,0.04,0.24l0-0.01c0.01-0.07-0.08-0.11-0.11-0.11c-0.03,0.03-0.03,0.05-0.02,0.08c0.02,0.03-0.1,0.05-0.12,0.08c-0.01,0.02,0.01,0.02-0.01,0.02c-0.03,0.01-0.08,0.06-0.13,0.03c0.02-0.01,0.06-0.01,0.07-0.02c-0.03,0.01-0.08,0.01-0.1,0.04c0.03-0.01,0.06-0.01,0.08-0.02c-0.02,0-0.05,0-0.06,0.01c0.04-0.01,0.05-0.03,0.08-0.03c0.03,0,0.06,0.03,0.09,0.04c0.02,0,0.04,0,0.05,0.02c0.02,0.03-0.1,0.08-0.09,0.1c0,0.01,0.03,0,0.07,0c0.05-0.01,0.1-0.05,0.15-0.07c0.12-0.04,0.22-0.08,0.32-0.12c0.22-0.08,0.37-0.2,0.6-0.04c-0.12-0.03-0.16,0.06-0.12,0.11c0,0.08,0.06,0.1,0.13,0.08c0.08-0.02,0.12-0.09,0.21-0.02c-0.02,0.09-0.11,0.11-0.19,0.07z" fill="url(#karion-gradient-1)"/>
          <path d="M7.34-0.34c0.35,0,0.65,0.04,0.81,0.09c-0.23-0.03-0.51-0.05-0.81-0.05c-0.3,0-0.58,0.02-0.81,0.05c0.16-0.06,0.46-0.09,0.81-0.09z" fill="url(#karion-gradient-2)"/>
        </g>
        <path d="M2.57,0.05v0.07c-0.12,0.03-0.26,0.1-0.39,0.18c-0.14,0.08-0.29,0.18-0.44,0.35l-0.7,0.84l0.22-0.31l0.89,1.38c0.05,0.09,0.11,0.14,0.17,0.19c0.06,0.05,0.16,0.09,0.16,0.09v0.07c-0.13-0.01-0.29-0.01-0.45-0.01c-0.08,0-0.19,0-0.31,0c-0.11,0-0.29,0.01-0.29,0.01v-0.07c0.15-0.01,0.18-0.04,0.21-0.08c0.03-0.03-0.03-0.12-0.09-0.21l-0.54-0.88c-0.05-0.09-0.09-0.13-0.14-0.17c-0.04-0.04-0.08-0.06-0.13-0.07c-0.04-0.02-0.11-0.02-0.11-0.02v-0.08c0.16,0,0.29-0.01,0.42-0.1c0.13-0.08,0.28-0.18,0.43-0.36l0.22-0.26c0.14-0.17,0.17-0.29,0.14-0.41c-0.07-0.07-0.23-0.07-0.37-0.07v-0.07c0.14,0,0.3,0.01,0.46,0.01c0.18,0,0.35,0,0.49-0.01M1.28,0.05v0.07c-0.12,0-0.18,0.03-0.2,0.09c-0.02,0.07-0.02,0.13-0.02,0.27v1.85c0,0.13,0.01,0.2,0.03,0.27c0.02,0.07,0.06,0.09,0.12,0.12c0.06,0.02,0.18,0.03,0.18,0.03v0.07c-0.1-0.01-0.25-0.01-0.41-0.01c-0.18,0-0.36,0-0.51,0.01c-0.16,0.01-0.25,0.01-0.25,0.01v-0.07c0.12-0.01,0.18-0.03,0.2-0.09c0.02-0.07,0.02-0.13,0.02-0.27v-1.85c0-0.14-0.01-0.2-0.03-0.27c-0.02-0.07-0.08-0.09-0.14-0.12c-0.06-0.02-0.18-0.03-0.18-0.03v-0.07c0.09,0,0.25,0.01,0.41,0.01c0.16,0,0.32,0,0.47-0.01c0.15,0,0.25-0.01,0.31-0.01M4.04,0.04l0.91,2.33c0.05,0.13,0.12,0.18,0.18,0.24c0.07,0.05,0.12,0.05,0.12,0.05v0.07c-0.11-0.01-0.26-0.01-0.42-0.01c-0.17,0-0.33,0-0.49,0c-0.12,0-0.28,0-0.44,0.01v-0.07c0.19-0.01,0.24-0.07,0.19-0.14c-0.05-0.06-0.13-0.25-0.19-0.44l-0.63-1.73l0.07-0.1l-0.57,1.48c-0.1,0.28-0.1,0.42-0.1,0.56c0,0.14,0.09,0.19,0.24,0.25c0.14,0.01,0.14,0.01,0.14,0.01v0.07c-0.12-0.01-0.24-0.01-0.34-0.01c-0.11,0-0.22,0-0.33,0c-0.08,0-0.15,0-0.22,0c-0.07,0.01-0.13,0.01-0.13,0.01v-0.07c0.08-0.02,0.16-0.1,0.24-0.19c0.08-0.09,0.16-0.3,0.24-0.5l0.85-2.18c0.06,0,0.13,0,0.19,0c0.07,0,0.14,0,0.2-0.01M4.3,1.62v0.07h-1.11l0.04-0.07h1.07M6.35,0.05v0.07c-0.12,0-0.18,0.03-0.2,0.09c-0.02,0.07-0.02,0.13-0.02,0.27v1.85c0,0.13,0.02,0.2,0.04,0.27c0.02,0.07,0.08,0.09,0.14,0.12c0.06,0.02,0.18,0.03,0.18,0.03v0.07c-0.1-0.01-0.25-0.01-0.41-0.01c-0.18,0-0.34,0-0.49,0.01c-0.15,0.01-0.25,0.01-0.25,0.01v-0.07c0.12-0.01,0.18-0.03,0.2-0.09c0.02-0.07,0.02-0.13,0.02-0.27v-1.85c0-0.14-0.01-0.2-0.03-0.27c-0.02-0.07-0.08-0.09-0.14-0.12c-0.06-0.02-0.18-0.03-0.18-0.03v-0.07c0.1,0,0.25,0.01,0.41,0.01c0.16,0,0.31,0,0.46-0.01c0.15,0,0.26-0.01,0.27-0.01M6.6,0.05c0.09,0,0.25,0.01,0.41,0.01c0.16,0,0.33,0,0.5-0.01c0.17,0,0.24,0,0.24,0c0.52,0,0.78,0.17,0.94,0.39c0.16,0.22,0.16,0.53,0.16,0.85c0,0.42-0.17,0.73-0.47,0.9c-0.3,0.18-0.68,0.35-1.07,0.35h-0.32v-0.07h0.32c0.22,0,0.33-0.08,0.41-0.17c0.07-0.08,0.11-0.23,0.13-0.38c0.02-0.16,0.02-0.32,0.02-0.5c0-0.29-0.1-0.46-0.26-0.62c-0.1-0.11-0.25-0.11-0.4-0.11c-0.14,0-0.19,0.06-0.23,0.13c-0.04,0.06-0.04,0.26-0.04,0.46v1.85c0,0.13,0.02,0.2,0.04,0.27c0.02,0.07,0.08,0.09,0.14,0.12c0.06,0.02,0.18,0.03,0.18,0.03v0.07c-0.1-0.01-0.25-0.01-0.41-0.01c-0.15,0-0.31,0-0.46,0.01c-0.15,0.01-0.25,0.01-0.25,0.01v-0.07c0.12-0.01,0.18-0.03,0.2-0.09c0.02-0.07,0.02-0.13,0.02-0.27v-1.85c0-0.14-0.01-0.2-0.03-0.27c-0.02-0.07-0.08-0.09-0.14-0.12c-0.06-0.02-0.18-0.03-0.18-0.03v-0.07M7.31,1.38c0.16,0,0.28,0.01,0.4,0.02c0.12,0.01,0.21,0.02,0.3,0.03c0.09,0.01,0.16,0.01,0.23,0.02c0.34,0.03,0.5,0.15,0.55,0.38l0.09,0.38c0.03,0.15,0.07,0.21,0.1,0.27c0.04,0.06,0.11,0.06,0.11,0.06c0.05,0,0.08-0.01,0.11-0.04c0.03-0.02,0.07-0.06,0.11-0.1l0.05,0.05c-0.1,0.12-0.22,0.17-0.34,0.22c-0.12,0.05-0.28,0.05-0.44,0.05c-0.2,0-0.33-0.09-0.44-0.17c-0.11-0.09-0.15-0.32-0.19-0.55l-0.07-0.37c-0.03-0.16-0.06-0.28-0.1-0.35c-0.06-0.07-0.12-0.11-0.24-0.11h-0.4l-0.01,0.06M10.54,0c0.4,0,0.69,0.16,0.89,0.36c0.2,0.2,0.33,0.5,0.33,0.79c0,0.42-0.17,0.73-0.47,0.9c-0.3,0.18-0.68,0.35-1.07,0.35c-0.4,0-0.7-0.16-0.89-0.37c-0.2-0.2-0.33-0.5-0.33-0.78c0-0.42,0.17-0.73,0.47-0.9c0.3-0.18,0.65-0.35,1.07-0.35M10.52,0.07c-0.21,0-0.36,0.17-0.47,0.34c-0.1,0.17-0.17,0.42-0.17,0.81c0,0.4,0.1,0.69,0.2,0.99c0.1,0.29,0.26,0.45,0.42,0.6c0.16,0.16,0.38,0.16,0.59,0.16c0.21,0,0.36-0.17,0.47-0.34c0.1-0.17,0.17-0.41,0.17-0.8c0-0.4-0.1-0.69-0.2-0.98c-0.1-0.29-0.26-0.45-0.42-0.6c-0.16-0.16-0.38-0.18-0.59-0.18M14.57,0.05v0.07c-0.12,0.02-0.18,0.06-0.24,0.14c-0.06,0.05-0.08,0.15-0.1,0.25c-0.02,0.1-0.02,0.29-0.02,0.46v2.08c-0.04,0-0.09,0-0.14,0c-0.05,0-0.1,0-0.14,0l-1.62-2.05v1.43c0,0.21,0.02,0.31,0.05,0.42c0.02,0.11,0.08,0.16,0.16,0.2c0.08,0.05,0.24,0.07,0.24,0.07v0.07c-0.07-0.01-0.19-0.01-0.3-0.01c-0.12,0-0.22,0-0.32,0c-0.09,0-0.18,0-0.27,0.01c-0.09,0.01-0.15,0.01-0.15,0.01v-0.07c0.12-0.02,0.18-0.06,0.24-0.14c0.06-0.05,0.08-0.15,0.1-0.25c0.02-0.1,0.02-0.28,0.02-0.46v-1.68c0-0.14-0.02-0.2-0.04-0.27c-0.02-0.07-0.08-0.09-0.14-0.12c-0.06-0.02-0.18-0.03-0.18-0.03v-0.07c0.06,0,0.15,0.01,0.24,0.01c0.09,0,0.19,0,0.28,0c0.09,0,0.17,0,0.26-0.01c0.08,0,0.15-0.01,0.15-0.01l1.44,1.78v-1.17c0-0.21-0.02-0.32-0.05-0.43c-0.02-0.11-0.1-0.16-0.18-0.2c-0.08-0.05-0.24-0.07-0.24-0.07v-0.07c0.07,0.01,0.19,0.01,0.3,0.01c0.12,0,0.22,0,0.32,0c0.09,0,0.18,0,0.27-0.01c0.09,0,0.15,0,0.15,0" fill="#e8e8e8"/>
      </svg>
    </div>
  );
};

export const Layout = () => {
  const [sidebarOpen, setSidebarOpen] = useState(false);

  return (
    <div className="min-h-screen bg-background relative">
      {/* Particles Background */}
      <Particles />
      
      {/* Sidebar */}
      <Sidebar isOpen={sidebarOpen} onClose={() => setSidebarOpen(false)} />

      {/* Main Content */}
      <main className="lg:ml-20 min-h-screen pb-20 lg:pb-0">
        {/* Desktop Header with Karion Logo */}
        <header className="hidden lg:flex items-center justify-center py-5 border-b border-border/30">
          <KarionLogo size="default" />
        </header>

        {/* Mobile Header */}
        <header className="lg:hidden sticky top-0 z-30 glass border-b border-border">
          <div className="flex items-center justify-between px-4 py-3">
            <button
              onClick={() => setSidebarOpen(true)}
              className="p-2 hover:bg-secondary rounded-lg transition-colors"
              data-testid="mobile-menu-btn"
            >
              <Menu className="w-6 h-6" />
            </button>
            <KarionLogo size="small" />
            <div className="w-10" />
          </div>
        </header>

        {/* Page Content */}
        <div className="p-4 md:p-6 lg:p-8">
          <Outlet />
        </div>
      </main>

      {/* Mobile Bottom Navigation */}
      <MobileNav onSearchClick={() => {}} />
    </div>
  );
};

export default Layout;
